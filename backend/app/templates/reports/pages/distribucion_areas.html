{# Página 7: Distribución por Áreas y Localidades #}
{% include 'reports/components/header.html' %}

<div class="section">
    <h2 class="section-title">Distribución por Áreas y Localidades</h2>
    
    {# Commentary narrativo #}
    {% if area_commentary %}
    <div class="commentary-box" style="background: #F0F8FF; padding: 20px; margin-bottom: 25px; border-left: 4px solid #4472C4; border-radius: 8px;">
        <p style="font-size: 18px; line-height: 1.6; color: #1F2937;">{{ area_commentary }}</p>
    </div>
    {% endif %}
    
    {# Distribución por área #}
    <h3 class="section-subtitle">Ingresos por Área</h3>
    {% if ingresos_por_area %}
    <table>
        <thead>
            <tr>
                <th>Área</th>
                <th class="text-right">Ingresos</th>
                <th class="text-right">Porcentaje</th>
            </tr>
        </thead>
        <tbody>
            {% for item in ingresos_por_area %}
            <tr>
                <td class="font-semibold">{{ item.nombre }}</td>
                <td class="text-right">{{ item.valor | format_currency }}</td>
                <td class="text-right">{{ item.porcentaje | format_percentage }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
    {# Distribución por localidad #}
    <h3 class="section-subtitle mt-20">Ingresos por Localidad</h3>
    {% if ingresos_por_localidad %}
    <table>
        <thead>
            <tr>
                <th>Localidad</th>
                <th class="text-right">Ingresos</th>
                <th class="text-right">Porcentaje</th>
            </tr>
        </thead>
        <tbody>
            {% for item in ingresos_por_localidad %}
            <tr>
                <td class="font-semibold">{{ item.nombre }}</td>
                <td class="text-right">{{ item.valor | format_currency }}</td>
                <td class="text-right">{{ item.porcentaje | format_percentage }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
    {# Gráficos de distribución lado a lado (grande y profesional) #}
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin: 40px 0;">
        <div style="text-align: center;">
            {% if area_donut_chart_path %}
            <h3 style="margin-bottom: 20px; font-size: 18px; color: #374151;">Distribución por Área</h3>
            <img src="{{ area_donut_chart_path }}" 
                 alt="Distribución por Área"
                 style="width: 100%; max-width: 650px; height: auto; display: block; margin: 0 auto;">
            {% endif %}
        </div>
        <div style="text-align: center;">
            {% if localidad_donut_chart_path %}
            <h3 style="margin-bottom: 20px; font-size: 18px; color: #374151;">Distribución por Localidad</h3>
            <img src="{{ localidad_donut_chart_path }}" 
                 alt="Distribución por Localidad"
                 style="width: 100%; max-width: 650px; height: auto; display: block; margin: 0 auto;">
            {% endif %}
        </div>
    </div>
</div>

<div class="page-break"></div>

